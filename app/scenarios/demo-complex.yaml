# Example complex scenario for MLMD population
# Shows multiple models, richer properties, multiple contexts, and cross-run lineage via events

types:
  artifact:
    Model:
      properties:
        name: STRING
        version: STRING
        framework: STRING
        format: STRING
        accuracy: DOUBLE
    Library:
      properties:
        name: STRING
        version: STRING
        purl: STRING
    Dataset:
      properties:
        name: STRING
        split: STRING
        version: STRING
        rows: INT
  execution:
    TrainingRun:
      properties:
        pipeline: STRING
        state: STRING
        run_id: STRING
        epochs: INT
  context:
    Experiment:
      properties:
        note: STRING
    Pipeline:
      properties:
        owner: STRING

contexts:
  expA:
    type: Experiment
    name: expA
    properties:
      note: "Experiment A"
  expB:
    type: Experiment
    name: expB
    properties:
      note: "Experiment B"
  pipe1:
    type: Pipeline
    name: demo-pipeline
    properties:
      owner: ml-team

artifacts:
  ds1:
    type: Dataset
    uri: data://demo-dataset/2025-10-01/train
    properties:
      name: demo-dataset
      split: train
      version: 2025-10-01
      rows: 100000
    contexts: [pipe1]
  lib_np_121:
    type: Library
    uri: pkg://numpy/1.21.0
    properties:
      name: numpy
      version: 1.21.0
      purl: pkg:pypi/numpy@1.21.0
  lib_tf_260:
    type: Library
    uri: pkg://tensorflow/2.6.0
    properties:
      name: tensorflow
      version: 2.6.0
      purl: pkg:pypi/tensorflow@2.6.0
  model_v1:
    type: Model
    uri: models://fakenet/1.0.0
    properties:
      name: FakeNet
      version: 1.0.0
      framework: TensorFlow
      format: SavedModel
      accuracy: 0.88

  ds2:
    type: Dataset
    uri: data://demo-dataset/2025-10-02/train
    properties:
      name: demo-dataset
      split: train
      version: 2025-10-02
      rows: 120000
    contexts: [pipe1]
  lib_np_122:
    type: Library
    uri: pkg://numpy/1.22.0
    properties:
      name: numpy
      version: 1.22.0
      purl: pkg:pypi/numpy@1.22.0
  lib_tf_270:
    type: Library
    uri: pkg://tensorflow/2.7.0
    properties:
      name: tensorflow
      version: 2.7.0
      purl: pkg:pypi/tensorflow@2.7.0
  lib_pd_135:
    type: Library
    uri: pkg://pandas/1.3.5
    properties:
      name: pandas
      version: 1.3.5
      purl: pkg:pypi/pandas@1.3.5
  model_v11:
    type: Model
    uri: models://fakenet/1.1.0
    properties:
      name: FakeNet
      version: 1.1.0
      framework: TensorFlow
      format: SavedModel
      accuracy: 0.91

executions:
  run1:
    type: TrainingRun
    properties:
      pipeline: demo-pipeline
      state: COMPLETED
      run_id: run-001
      epochs: 10
    contexts: [expA, pipe1]
  run2:
    type: TrainingRun
    properties:
      pipeline: demo-pipeline
      state: COMPLETED
      run_id: run-002
      epochs: 12
    contexts: [expB, pipe1]

# Link IO via events
# run1: inputs (ds1, libs), output (model_v1)
# run2: inputs (ds2, libs), output (model_v11)

events:
  - { execution: run1, type: INPUT, artifact: ds1 }
  - { execution: run1, type: INPUT, artifact: lib_np_121 }
  - { execution: run1, type: INPUT, artifact: lib_tf_260 }
  - { execution: run1, type: OUTPUT, artifact: model_v1 }

  - { execution: run2, type: INPUT, artifact: ds2 }
  - { execution: run2, type: INPUT, artifact: lib_np_122 }
  - { execution: run2, type: INPUT, artifact: lib_tf_270 }
  - { execution: run2, type: INPUT, artifact: lib_pd_135 }
  - { execution: run2, type: OUTPUT, artifact: model_v11 }

# Optional explicit links (in addition to inline contexts)
associations:
  - { context: pipe1, execution: run1 }
  - { context: pipe1, execution: run2 }

attributions:
  - { context: expA, artifact: model_v1 }
  - { context: expB, artifact: model_v11 }
